package basicsofhibernate;

import static org.junit.jupiter.api.Assertions.assertNotNull;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.EntityTransaction;
import javax.persistence.Persistence;

import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

import com.product.Product;
import com.product.ProductCRUD;

public class ProductCrudTest {
	
	static EntityManagerFactory emf ;
	EntityManager em = emf.createEntityManager();
	EntityTransaction et = em.getTransaction();
	
//	@BeforeEach
	@BeforeAll
	public static void initEmf() {
		System.out.println("init EMF");
		emf = Persistence.createEntityManagerFactory("postgres");
	}

	@Test
	public void addProductTest() {
		
		System.out.println("Product Insert");
		ProductCRUD crud = new ProductCRUD();
		
		Product p = new Product();
		p.setId(102);
		p.setName("Powder");
		p.setPrice(90);
		p.setQuantity(100);
		
		crud.addProducts(et, em,p);
		
		emf.close();
	}
	
	
	@Test
	public void testFindByIDTest() {
		Product p = em.find(Product.class, 101);
		assertNotNull(p);
	}
}
